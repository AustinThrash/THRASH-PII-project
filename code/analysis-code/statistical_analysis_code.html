<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Austin Thrash">
<meta name="dcterms.date" content="2024-06-21">

<title>Manuscript for a Data Analysis Project: Diabetes Diagnosis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="statistical_analysis_code_files/libs/clipboard/clipboard.min.js"></script>
<script src="statistical_analysis_code_files/libs/quarto-html/quarto.js"></script>
<script src="statistical_analysis_code_files/libs/quarto-html/popper.min.js"></script>
<script src="statistical_analysis_code_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="statistical_analysis_code_files/libs/quarto-html/anchor.min.js"></script>
<link href="statistical_analysis_code_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="statistical_analysis_code_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="statistical_analysis_code_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="statistical_analysis_code_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="statistical_analysis_code_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup---loading-in-packages" id="toc-setup---loading-in-packages" class="nav-link active" data-scroll-target="#setup---loading-in-packages"><span class="header-section-number">0.1</span> SETUP - Loading In Packages</a></li>
  <li><a href="#setup---loading-in-the-data" id="toc-setup---loading-in-the-data" class="nav-link" data-scroll-target="#setup---loading-in-the-data"><span class="header-section-number">0.2</span> SETUP - Loading In The Data</a></li>
  <li><a href="#setup---processing-data" id="toc-setup---processing-data" class="nav-link" data-scroll-target="#setup---processing-data"><span class="header-section-number">0.3</span> SETUP - Processing Data</a></li>
  <li><a href="#statistical-analysis" id="toc-statistical-analysis" class="nav-link" data-scroll-target="#statistical-analysis"><span class="header-section-number">1</span> Statistical Analysis</a>
  <ul class="collapse">
  <li><a href="#multinomial-logistic-regression" id="toc-multinomial-logistic-regression" class="nav-link" data-scroll-target="#multinomial-logistic-regression"><span class="header-section-number">1.1</span> Multinomial Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#one-hot-encoding" id="toc-one-hot-encoding" class="nav-link" data-scroll-target="#one-hot-encoding"><span class="header-section-number">1.1.1</span> One-Hot Encoding</a></li>
  <li><a href="#training" id="toc-training" class="nav-link" data-scroll-target="#training"><span class="header-section-number">1.1.2</span> Training</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">1.1.3</span> Results</a></li>
  </ul></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest"><span class="header-section-number">1.2</span> Random Forest</a>
  <ul class="collapse">
  <li><a href="#sampling-data" id="toc-sampling-data" class="nav-link" data-scroll-target="#sampling-data"><span class="header-section-number">1.2.1</span> Sampling Data</a></li>
  <li><a href="#training-1" id="toc-training-1" class="nav-link" data-scroll-target="#training-1"><span class="header-section-number">1.2.2</span> Training</a></li>
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1"><span class="header-section-number">1.2.3</span> Results</a></li>
  </ul></li>
  <li><a href="#knn" id="toc-knn" class="nav-link" data-scroll-target="#knn"><span class="header-section-number">1.3</span> KNN</a>
  <ul class="collapse">
  <li><a href="#training-2" id="toc-training-2" class="nav-link" data-scroll-target="#training-2"><span class="header-section-number">1.3.1</span> Training</a></li>
  <li><a href="#results-2" id="toc-results-2" class="nav-link" data-scroll-target="#results-2"><span class="header-section-number">1.3.2</span> Results</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Manuscript for a Data Analysis Project: Diabetes Diagnosis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Austin Thrash </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 21, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="setup---loading-in-packages" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="setup---loading-in-packages"><span class="header-section-number">0.1</span> SETUP - Loading In Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading in necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ISLR2':

    Boston</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded glmnet 4.1-8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pls'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    loadings</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: splines</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: foreach</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded gam 1.22-3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fastDummies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Thank you for using fastDummies!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>To acknowledge our work, please cite the package:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Kaplan, J. &amp; Schlegel, B. (2023). fastDummies: Fast Creation of Dummy (Binary) Columns and Rows from Categorical Variables. Version 1.7.1. URL: https://github.com/jacobkap/fastDummies, https://jacobkap.github.io/fastDummies/.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lattice'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:boot':

    melanoma</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'caret'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:pls':

    R2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MLmetrics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:caret':

    MAE, RMSE</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    Recall</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'randomForest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
</div>
</section>
<section id="setup---loading-in-the-data" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="setup---loading-in-the-data"><span class="header-section-number">0.2</span> SETUP - Loading In The Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This chunk is used to load in the data and display its structure:</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ OUTPUT: ------</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 'data.frame': 253680 obs. of  22 variables:</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># $ Diabetes_012        : num  0 0 0 0 0 0 0 0 2 0 ...</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># $ HighBP              : num  1 0 1 1 1 1 1 1 1 0 ...</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># $ HighChol            : num  1 0 1 0 1 1 0 1 1 0 ...</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># $ CholCheck           : num  1 0 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># $ BMI                 : num  40 25 28 27 24 25 30 25 30 24 ...</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># $ Smoker              : num  1 1 0 0 0 1 1 1 1 0 ...</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># $ Stroke              : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># $ HeartDiseaseorAttack: num  0 0 0 0 0 0 0 0 1 0 ...</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co"># $ PhysActivity        : num  0 1 0 1 1 1 0 1 0 0 ...</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># $ Fruits              : num  0 0 1 1 1 1 0 0 1 0 ...</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># $ Veggies             : num  1 0 0 1 1 1 0 1 1 1 ...</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co"># $ HvyAlcoholConsump   : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># $ AnyHealthcare       : num  1 0 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># $ NoDocbcCost         : num  0 1 1 0 0 0 0 0 0 0 ...</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># $ GenHlth             : num  5 3 5 2 2 2 3 3 5 2 ...</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co"># $ MentHlth            : num  18 0 30 0 3 0 0 0 30 0 ...</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="co"># $ PhysHlth            : num  15 0 30 0 0 2 14 0 30 0 ...</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co"># $ DiffWalk            : num  1 0 1 0 0 0 0 1 1 0 ...</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co"># $ Sex                 : num  0 0 0 0 0 1 0 0 0 1 ...</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="co"># $ Age                 : num  9 7 9 11 11 10 9 11 9 8 ...</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co"># $ Education           : num  4 6 4 3 5 6 6 4 5 4 ...</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="co"># $ Income              : num  3 1 8 6 4 8 7 4 1 3 ...</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading in the data from the proper location</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>data_location <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"processed-data"</span>,<span class="st">"processeddata.rds"</span>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the readRDS() function to load the data into a variable</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>diabetes <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(data_location)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the structure</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(diabetes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   253680 obs. of  22 variables:
 $ Diabetes_012        : num  0 0 0 0 0 0 0 0 2 0 ...
 $ HighBP              : num  1 0 1 1 1 1 1 1 1 0 ...
 $ HighChol            : num  1 0 1 0 1 1 0 1 1 0 ...
 $ CholCheck           : num  1 0 1 1 1 1 1 1 1 1 ...
 $ BMI                 : num  40 25 28 27 24 25 30 25 30 24 ...
 $ Smoker              : num  1 1 0 0 0 1 1 1 1 0 ...
 $ Stroke              : num  0 0 0 0 0 0 0 0 0 0 ...
 $ HeartDiseaseorAttack: num  0 0 0 0 0 0 0 0 1 0 ...
 $ PhysActivity        : num  0 1 0 1 1 1 0 1 0 0 ...
 $ Fruits              : num  0 0 1 1 1 1 0 0 1 0 ...
 $ Veggies             : num  1 0 0 1 1 1 0 1 1 1 ...
 $ HvyAlcoholConsump   : num  0 0 0 0 0 0 0 0 0 0 ...
 $ AnyHealthcare       : num  1 0 1 1 1 1 1 1 1 1 ...
 $ NoDocbcCost         : num  0 1 1 0 0 0 0 0 0 0 ...
 $ GenHlth             : num  5 3 5 2 2 2 3 3 5 2 ...
 $ MentHlth            : num  18 0 30 0 3 0 0 0 30 0 ...
 $ PhysHlth            : num  15 0 30 0 0 2 14 0 30 0 ...
 $ DiffWalk            : num  1 0 1 0 0 0 0 1 1 0 ...
 $ Sex                 : num  0 0 0 0 0 1 0 0 0 1 ...
 $ Age                 : num  9 7 9 11 11 10 9 11 9 8 ...
 $ Education           : num  4 6 4 3 5 6 6 4 5 4 ...
 $ Income              : num  3 1 8 6 4 8 7 4 1 3 ...</code></pre>
</div>
</div>
</section>
<section id="setup---processing-data" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="setup---processing-data"><span class="header-section-number">0.3</span> SETUP - Processing Data</h2>
<p>Although we processed the data prior, I will perform some further processing to ensure the data works properly when used in the models. Here is the structure of the dataset, so variables will be modified accordingly.</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ID</td>
<td>Patient ID</td>
</tr>
<tr class="even">
<td>Diabetes_binary</td>
<td>0 = no diabetes 1 = prediabetes or diabetes</td>
</tr>
<tr class="odd">
<td>HighBP</td>
<td>0 = no high BP 1 = high BP</td>
</tr>
<tr class="even">
<td>HighChol</td>
<td>0 = no high cholesterol 1 = high cholesterol</td>
</tr>
<tr class="odd">
<td>CholCheck</td>
<td>0 = no cholesterol check in 5 years 1 = yes cholesterol check in 5 years</td>
</tr>
<tr class="even">
<td>BMI</td>
<td>Body Mass Index</td>
</tr>
<tr class="odd">
<td>Smoker</td>
<td>Have you smoked at least 100 cigarettes in your entire life? [Note: 5 packs = 100 cigarettes] 0 = no 1 = yes</td>
</tr>
<tr class="even">
<td>Stoke</td>
<td>(Ever told) you had a stroke. 0 = no 1 = yes</td>
</tr>
<tr class="odd">
<td>HeartDiseaseorAttack</td>
<td>coronary heart disease (CHD) or myocardial infarction (MI) 0 = no 1 = yes</td>
</tr>
<tr class="even">
<td>PhysActivity</td>
<td>physical activity in past 30 days - not including job 0 = no 1 = yes</td>
</tr>
<tr class="odd">
<td>Fruits</td>
<td>Consume Fruit 1 or more times per day 0 = no 1 = yes</td>
</tr>
<tr class="even">
<td>Veggies</td>
<td>Consume Vegetables 1 or more times per day 0 = no 1 = yes</td>
</tr>
<tr class="odd">
<td>HvyAlchoholConsump</td>
<td>Heavy drinkers (adult men having more than 14 drinks per week and adult women having more than 7 drinks per week) 0 = no 1 = yes</td>
</tr>
<tr class="even">
<td>AnyHealthcare</td>
<td>Have any kind of health care coverage, including health insurance, prepaid plans such as HMO, etc. 0 = no 1 = yes</td>
</tr>
<tr class="odd">
<td>NoDocbcCost</td>
<td>Was there a time in the past 12 months when you needed to see a doctor but could not because of cost? 0 = no 1 = yes</td>
</tr>
<tr class="even">
<td>GenHlth</td>
<td>Would you say that in general your health is: scale 1-5 1 = excellent 2 = very good 3 = good 4 = fair 5 = poor</td>
</tr>
<tr class="odd">
<td>MentHlth</td>
<td>Now thinking about your mental health, which includes stress, depression, and problems with emotions, for how many days during the past 30 days was your mental health not good? scale 1-30 days</td>
</tr>
<tr class="even">
<td>PhysHlth</td>
<td>Now thinking about your physical health, which includes physical illness and injury, for how many days during the past 30 days was your physical health not good? scale 1-30 days</td>
</tr>
<tr class="odd">
<td>DiffWalk</td>
<td>Do you have serious difficulty walking or climbing stairs? 0 = no 1 = yes</td>
</tr>
<tr class="even">
<td>Sex</td>
<td>0 = female 1 = male</td>
</tr>
<tr class="odd">
<td>Age</td>
<td>13-level age category (_AGEG5YR see codebook) 1 = 18-24 9 = 60-64 13 = 80 or older</td>
</tr>
<tr class="even">
<td>Education</td>
<td>Education level (EDUCA see codebook) scale 1-6 1 = Never attended school or only kindergarten 2 = Grades 1 through 8 (Elementary) 3 = Grades 9 through 11 (Some high school) 4 = Grade 12 or GED (High school graduate) 5 = College 1 year to 3 years (Some college or technical school) 6 = College 4 years or more (College graduate)</td>
</tr>
<tr class="odd">
<td>Income</td>
<td>Income scale (INCOME2 see codebook) scale 1-8 1 = less than $10,000 5 = less than $35,000 8 = $75,000 or more</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This chunk is used to further process the data</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Copying data</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>proc_data <span class="ot">&lt;-</span> diabetes</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing ID column</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Target</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>Diabetes_012 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>Diabetes_012)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(proc_data<span class="sc">$</span>Diabetes_012) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(<span class="fu">levels</span>(proc_data<span class="sc">$</span>Diabetes_012))</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Features</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>HighBP <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>HighBP)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>HighChol <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>HighChol)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>CholCheck <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>CholCheck)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>Smoker <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>Smoker)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>Stroke <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>Stroke)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>HeartDiseaseorAttack <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>HeartDiseaseorAttack)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>PhysActivity <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>PhysActivity)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>Fruits <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>Fruits)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>Veggies <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>Veggies)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>HvyAlcoholConsump <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>HvyAlcoholConsump)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>AnyHealthcare <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>AnyHealthcare)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>NoDocbcCost <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>NoDocbcCost)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>GenHlth <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>GenHlth)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>MentHlth <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>MentHlth)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>PhysHlth <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>PhysHlth)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>DiffWalk <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>DiffWalk)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>Sex)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>Age)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>Education <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>Education)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>proc_data<span class="sc">$</span>Income <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(proc_data<span class="sc">$</span>Income)</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(proc_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   253680 obs. of  22 variables:
 $ Diabetes_012        : Factor w/ 3 levels "X0","X1","X2": 1 1 1 1 1 1 1 1 3 1 ...
 $ HighBP              : Factor w/ 2 levels "0","1": 2 1 2 2 2 2 2 2 2 1 ...
 $ HighChol            : Factor w/ 2 levels "0","1": 2 1 2 1 2 2 1 2 2 1 ...
 $ CholCheck           : Factor w/ 2 levels "0","1": 2 1 2 2 2 2 2 2 2 2 ...
 $ BMI                 : num  40 25 28 27 24 25 30 25 30 24 ...
 $ Smoker              : Factor w/ 2 levels "0","1": 2 2 1 1 1 2 2 2 2 1 ...
 $ Stroke              : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
 $ HeartDiseaseorAttack: Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 2 1 ...
 $ PhysActivity        : Factor w/ 2 levels "0","1": 1 2 1 2 2 2 1 2 1 1 ...
 $ Fruits              : Factor w/ 2 levels "0","1": 1 1 2 2 2 2 1 1 2 1 ...
 $ Veggies             : Factor w/ 2 levels "0","1": 2 1 1 2 2 2 1 2 2 2 ...
 $ HvyAlcoholConsump   : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
 $ AnyHealthcare       : Factor w/ 2 levels "0","1": 2 1 2 2 2 2 2 2 2 2 ...
 $ NoDocbcCost         : Factor w/ 2 levels "0","1": 1 2 2 1 1 1 1 1 1 1 ...
 $ GenHlth             : Factor w/ 5 levels "1","2","3","4",..: 5 3 5 2 2 2 3 3 5 2 ...
 $ MentHlth            : Factor w/ 31 levels "0","1","2","3",..: 19 1 31 1 4 1 1 1 31 1 ...
 $ PhysHlth            : Factor w/ 31 levels "0","1","2","3",..: 16 1 31 1 1 3 15 1 31 1 ...
 $ DiffWalk            : Factor w/ 2 levels "0","1": 2 1 2 1 1 1 1 2 2 1 ...
 $ Sex                 : Factor w/ 2 levels "0","1": 1 1 1 1 1 2 1 1 1 2 ...
 $ Age                 : Factor w/ 13 levels "1","2","3","4",..: 9 7 9 11 11 10 9 11 9 8 ...
 $ Education           : Factor w/ 6 levels "1","2","3","4",..: 4 6 4 3 5 6 6 4 5 4 ...
 $ Income              : Factor w/ 8 levels "1","2","3","4",..: 3 1 8 6 4 8 7 4 1 3 ...</code></pre>
</div>
</div>
<p>We can make note that a majority of our features are factors simply because most of the data recorded was on a scale, either binary (0-1), or a larger (1-8). Due to the data having so many categorical variables, we should opt to use models that more effectively handle categorical features. Therefore, we will start with a simple logistic regression, making use of one-hot encoding, then we will move on to models that may perform better such as random forest or KNN.</p>
</section>
<section id="statistical-analysis" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Statistical Analysis</h1>
<section id="multinomial-logistic-regression" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="multinomial-logistic-regression"><span class="header-section-number">1.1</span> Multinomial Logistic Regression</h2>
<section id="one-hot-encoding" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="one-hot-encoding"><span class="header-section-number">1.1.1</span> One-Hot Encoding</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting random sample</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">25500</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(proc_data), <span class="at">size =</span> sample_size, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> proc_data[sample_indices, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform one-hot encoding</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>sample_data_encoded <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(sample_data, <span class="at">remove_first_dummy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the original categorical columns</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"HighBP"</span>, <span class="st">"HighChol"</span>, <span class="st">"CholCheck"</span>, <span class="st">"Smoker"</span>, <span class="st">"Stroke"</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"HeartDiseaseorAttack"</span>, <span class="st">"PhysActivity"</span>, <span class="st">"Fruits"</span>, <span class="st">"Veggies"</span>, <span class="st">"HvyAlcoholConsump"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AnyHealthcare"</span>, <span class="st">"NoDocbcCost"</span>, <span class="st">"GenHlth"</span>, <span class="st">"MentHlth"</span>, <span class="st">"PhysHlth"</span>, <span class="st">"DiffWalk"</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sex"</span>, <span class="st">"Age"</span>, <span class="st">"Education"</span>, <span class="st">"Income"</span>, <span class="st">"Diabetes_012_1"</span>, <span class="st">"Diabetes_012_2"</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only the non-categorical columns and the one-hot encoded columns</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>sample_data_encoded <span class="ot">&lt;-</span> sample_data_encoded[, <span class="sc">!</span><span class="fu">names</span>(sample_data_encoded) <span class="sc">%in%</span> categorical_columns]</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the factor levels to valid variable names</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(sample_data_encoded<span class="sc">$</span>Diabetes_012) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(<span class="fu">levels</span>(sample_data_encoded<span class="sc">$</span>Diabetes_012))</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect the new data frame</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sample_data_encoded)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   25500 obs. of  106 variables:
 $ Diabetes_012          : Factor w/ 3 levels "X0","X1","X2": 1 1 1 3 1 1 1 1 1 1 ...
 $ BMI                   : num  23 35 20 28 29 23 25 23 22 30 ...
 $ Diabetes_012_X1       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Diabetes_012_X2       : int  0 0 0 1 0 0 0 0 0 0 ...
 $ HighBP_1              : int  0 1 0 1 1 0 0 1 0 0 ...
 $ HighChol_1            : int  0 0 0 0 0 1 0 0 0 0 ...
 $ CholCheck_1           : int  1 1 1 1 1 1 1 1 1 1 ...
 $ Smoker_1              : int  1 1 0 1 0 1 0 0 1 0 ...
 $ Stroke_1              : int  0 0 0 0 0 0 0 0 0 0 ...
 $ HeartDiseaseorAttack_1: int  0 0 0 0 0 1 0 0 0 0 ...
 $ PhysActivity_1        : int  1 1 0 1 1 1 1 1 1 1 ...
 $ Fruits_1              : int  0 1 1 1 1 1 1 0 1 1 ...
 $ Veggies_1             : int  1 1 1 0 1 1 0 0 1 1 ...
 $ HvyAlcoholConsump_1   : int  1 0 0 0 0 0 0 0 0 0 ...
 $ AnyHealthcare_1       : int  1 1 1 1 1 1 1 1 1 1 ...
 $ NoDocbcCost_1         : int  0 0 1 1 0 0 0 1 0 0 ...
 $ GenHlth_2             : int  0 1 0 0 0 1 0 0 0 1 ...
 $ GenHlth_3             : int  0 0 0 0 1 0 0 1 0 0 ...
 $ GenHlth_4             : int  0 0 0 1 0 0 0 0 0 0 ...
 $ GenHlth_5             : int  0 0 0 0 0 0 0 0 1 0 ...
 $ MentHlth_1            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_2            : int  0 0 0 0 1 0 0 0 0 0 ...
 $ MentHlth_3            : int  0 0 0 1 0 0 0 0 0 0 ...
 $ MentHlth_4            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_5            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_6            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_7            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_8            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_9            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_10           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_11           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_12           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_13           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_14           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_15           : int  0 0 0 0 0 0 0 1 0 0 ...
 $ MentHlth_16           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_17           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_18           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_19           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_20           : int  1 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_21           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_22           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_23           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_24           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_25           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_26           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_27           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_28           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_29           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ MentHlth_30           : int  0 0 0 0 0 0 0 0 1 0 ...
 $ PhysHlth_1            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_2            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_3            : int  0 1 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_4            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_5            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_6            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_7            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_8            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_9            : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_10           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_11           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_12           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_13           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_14           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_15           : int  0 0 0 1 0 0 0 0 0 0 ...
 $ PhysHlth_16           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_17           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_18           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_19           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_20           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_21           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_22           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_23           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_24           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_25           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_26           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_27           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_28           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_29           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PhysHlth_30           : int  0 0 0 0 0 0 0 0 1 0 ...
 $ DiffWalk_1            : int  0 0 0 1 1 0 0 0 1 0 ...
 $ Sex_1                 : int  0 0 0 0 0 0 1 0 1 0 ...
 $ Age_2                 : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Age_3                 : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Age_4                 : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Age_5                 : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Age_6                 : int  0 0 0 0 0 0 0 0 1 0 ...
 $ Age_7                 : int  0 0 1 0 0 0 1 0 0 0 ...
 $ Age_8                 : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Age_9                 : int  0 0 0 0 0 0 0 0 0 1 ...
 $ Age_10                : int  0 0 0 1 0 0 0 0 0 0 ...
 $ Age_11                : int  0 0 0 0 1 0 0 1 0 0 ...
 $ Age_12                : int  1 1 0 0 0 1 0 0 0 0 ...
 $ Age_13                : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Education_2           : int  0 0 0 0 0 0 0 1 0 0 ...
 $ Education_3           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Education_4           : int  0 0 0 1 0 0 0 0 1 0 ...
 $ Education_5           : int  0 0 1 0 1 0 0 0 0 1 ...
 $ Education_6           : int  1 1 0 0 0 1 1 0 0 0 ...
  [list output truncated]</code></pre>
</div>
</div>
</section>
<section id="training" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="training"><span class="header-section-number">1.1.2</span> Training</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">classProbs =</span> <span class="cn">TRUE</span>, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">summaryFunction =</span> multiClassSummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>logistic_model <span class="ot">&lt;-</span> <span class="fu">train</span>(Diabetes_012 <span class="sc">~</span> ., </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> sample_data_encoded, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">method =</span> <span class="st">"multinom"</span>, </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">trControl =</span> train_control,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">metric =</span> <span class="st">"Accuracy"</span>)  <span class="co"># Optimization metric can be "Accuracy" or "Kappa"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 477.056881
iter  20 value 409.548303
iter  30 value 324.519653
iter  40 value 281.799503
iter  50 value 208.956835
iter  60 value 175.886586
iter  70 value 139.901233
iter  80 value 102.962801
iter  90 value 51.331931
iter 100 value 24.409749
final  value 24.409749 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 481.964195
iter  20 value 416.402743
iter  30 value 332.813678
iter  40 value 274.891980
iter  50 value 212.328179
iter  60 value 169.523655
iter  70 value 128.472626
iter  80 value 81.391958
iter  90 value 54.791731
iter 100 value 34.187859
final  value 34.187859 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 477.061790
iter  20 value 409.556134
iter  30 value 324.522427
iter  40 value 283.897696
iter  50 value 186.474272
iter  60 value 149.412561
iter  70 value 125.577732
iter  80 value 67.637503
iter  90 value 45.321135
iter 100 value 18.209984
final  value 18.209984 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 470.890216
iter  20 value 361.768860
iter  30 value 281.370040
iter  40 value 174.789449
iter  50 value 130.177752
iter  60 value 100.743534
iter  70 value 69.513754
iter  80 value 48.658956
iter  90 value 20.794345
iter 100 value 5.911366
final  value 5.911366 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 475.844610
iter  20 value 369.586759
iter  30 value 309.466188
iter  40 value 224.321544
iter  50 value 203.691231
iter  60 value 166.035719
iter  70 value 125.551967
iter  80 value 103.000256
iter  90 value 74.238935
iter 100 value 51.509551
final  value 51.509551 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 470.895171
iter  20 value 361.784208
iter  30 value 281.346738
iter  40 value 215.817243
iter  50 value 171.629761
iter  60 value 120.727735
iter  70 value 94.804356
iter  80 value 58.210115
iter  90 value 34.601682
iter 100 value 16.275551
final  value 16.275551 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 480.052881
iter  20 value 352.330521
iter  30 value 248.925617
iter  40 value 220.092151
iter  50 value 182.396883
iter  60 value 141.920517
iter  70 value 97.856112
iter  80 value 70.068105
iter  90 value 36.630804
iter 100 value 15.884645
final  value 15.884645 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 485.011652
iter  20 value 360.420789
iter  30 value 280.769651
iter  40 value 210.105004
iter  50 value 185.048005
iter  60 value 143.680630
iter  70 value 108.538814
iter  80 value 68.329395
iter  90 value 48.569060
iter 100 value 30.851332
final  value 30.851332 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 480.057841
iter  20 value 352.314372
iter  30 value 248.990755
iter  40 value 217.539087
iter  50 value 181.007559
iter  60 value 146.341944
iter  70 value 116.174184
iter  80 value 86.443774
iter  90 value 58.087898
iter 100 value 23.198944
final  value 23.198944 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 454.436627
iter  20 value 390.450932
iter  30 value 342.554067
iter  40 value 283.134904
iter  50 value 240.418687
iter  60 value 187.700244
iter  70 value 128.520677
iter  80 value 93.406409
iter  90 value 64.807851
iter 100 value 33.872920
final  value 33.872920 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 459.368641
iter  20 value 391.465001
iter  30 value 328.025494
iter  40 value 289.777780
iter  50 value 241.928653
iter  60 value 187.938047
iter  70 value 159.677493
iter  80 value 100.450833
iter  90 value 51.667664
iter 100 value 31.714501
final  value 31.714501 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 454.441560
iter  20 value 390.448729
iter  30 value 342.618554
iter  40 value 273.903309
iter  50 value 223.143653
iter  60 value 143.665637
iter  70 value 103.119953
iter  80 value 60.013702
iter  90 value 40.528480
iter 100 value 19.761372
final  value 19.761372 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 449.453434
iter  20 value 405.156375
iter  30 value 337.502281
iter  40 value 262.790998
iter  50 value 197.949862
iter  60 value 135.979481
iter  70 value 97.027015
iter  80 value 62.981280
iter  90 value 39.643822
iter 100 value 19.470859
final  value 19.470859 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 454.317441
iter  20 value 377.885882
iter  30 value 317.674838
iter  40 value 248.266584
iter  50 value 208.901616
iter  60 value 170.663467
iter  70 value 125.810406
iter  80 value 77.287695
iter  90 value 49.253720
iter 100 value 28.740487
final  value 28.740487 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 22411.690689 
iter  10 value 449.458300
iter  20 value 405.147096
iter  30 value 337.494159
iter  40 value 261.548558
iter  50 value 204.297195
iter  60 value 141.294218
iter  70 value 110.166864
iter  80 value 87.446914
iter  90 value 62.063991
iter 100 value 33.803048
final  value 33.803048 
stopped after 100 iterations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth_13, MentHlth_19,
MentHlth_24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  321 (212 variable)
initial  value 28014.613361 
iter  10 value 235.114114
iter  20 value 182.783062
iter  30 value 157.343864
iter  40 value 139.031423
iter  50 value 119.210843
iter  60 value 97.384550
iter  70 value 78.771050
iter  80 value 55.570407
iter  90 value 38.873972
iter 100 value 28.134021
final  value 28.134021 
stopped after 100 iterations</code></pre>
</div>
</div>
</section>
<section id="results" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="results"><span class="header-section-number">1.1.3</span> Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(logistic_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Penalized Multinomial Regression 

25500 samples
  105 predictor
    3 classes: 'X0', 'X1', 'X2' 

Pre-processing: centered (105), scaled (105) 
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 20400, 20400, 20400, 20400, 20400 
Resampling results across tuning parameters:

  decay  logLoss      AUC        prAUC      Accuracy   Kappa      Mean_F1  
  0e+00  0.005071196  0.9990846  0.9936496  0.9996471  0.9986736  0.9983661
  1e-04  0.005107943  0.9989889  0.9941306  0.9996471  0.9986739  0.9980281
  1e-01  0.004365233  0.9990381  0.9943724  0.9996863  0.9988216  0.9977231
  Mean_Sensitivity  Mean_Specificity  Mean_Pos_Pred_Value  Mean_Neg_Pred_Value
  0.9979444         0.9995881         0.9988015            0.9997287          
  0.9980238         0.9996593         0.9980414            0.9996595          
  0.9987194         0.9997475         0.9967663            0.9997421          
  Mean_Precision  Mean_Recall  Mean_Detection_Rate  Mean_Balanced_Accuracy
  0.9988015       0.9979444    0.3332157            0.9987662             
  0.9980414       0.9980238    0.3332157            0.9988415             
  0.9967663       0.9987194    0.3332288            0.9992335             

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was decay = 0.1.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the same data (or a test dataset if you have one)</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(logistic_model, <span class="at">newdata =</span> sample_data_encoded)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predictions, sample_data_encoded<span class="sc">$</span>Diabetes_012)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    X0    X1    X2
        X0 21555     0     0
        X1     0   431     0
        X2     0     0  3514

Overall Statistics
                                     
               Accuracy : 1          
                 95% CI : (0.9999, 1)
    No Information Rate : 0.8453     
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16  
                                     
                  Kappa : 1          
                                     
 Mcnemar's Test P-Value : NA         

Statistics by Class:

                     Class: X0 Class: X1 Class: X2
Sensitivity             1.0000    1.0000    1.0000
Specificity             1.0000    1.0000    1.0000
Pos Pred Value          1.0000    1.0000    1.0000
Neg Pred Value          1.0000    1.0000    1.0000
Prevalence              0.8453    0.0169    0.1378
Detection Rate          0.8453    0.0169    0.1378
Detection Prevalence    0.8453    0.0169    0.1378
Balanced Accuracy       1.0000    1.0000    1.0000</code></pre>
</div>
</div>
</section>
</section>
<section id="random-forest" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="random-forest"><span class="header-section-number">1.2</span> Random Forest</h2>
<section id="sampling-data" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="sampling-data"><span class="header-section-number">1.2.1</span> Sampling Data</h3>
<p>I may need to change how I am sampling the data so I can make sure the sample is balanced.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting random sample</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">25500</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(proc_data), <span class="at">size =</span> sample_size, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> proc_data[sample_indices, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="training-1" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="training-1"><span class="header-section-number">1.2.2</span> Training</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">2</span>, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">classProbs =</span> <span class="cn">TRUE</span>, </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">summaryFunction =</span> multiClassSummary)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the random forest model using caret</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">train</span>(Diabetes_012 <span class="sc">~</span> ., </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> sample_data, </span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>, </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> train_control,</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">"Accuracy"</span>)  <span class="co"># Optimization metric can be "Accuracy" or "Kappa"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth13, MentHlth19, MentHlth23,
MentHlth24, PhysHlth23

Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth13, MentHlth19, MentHlth23,
MentHlth24, PhysHlth23

Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth13, MentHlth19, MentHlth23,
MentHlth24, PhysHlth23</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth13, MentHlth19, MentHlth24,
PhysHlth13

Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth13, MentHlth19, MentHlth24,
PhysHlth13

Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth13, MentHlth19, MentHlth24,
PhysHlth13</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo,
: There were missing values in resampled performance measures.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in preProcess.default(thresh = 0.95, k = 5, freqCut = 19, uniqueCut =
10, : These variables have zero variances: MentHlth13, MentHlth19, MentHlth24</code></pre>
</div>
</div>
</section>
<section id="results-1" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="results-1"><span class="header-section-number">1.2.3</span> Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rf_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

25500 samples
   21 predictor
    3 classes: 'X0', 'X1', 'X2' 

Pre-processing: centered (103), scaled (103) 
Resampling: Cross-Validated (2 fold) 
Summary of sample sizes: 12750, 12750 
Resampling results across tuning parameters:

  mtry  logLoss    AUC        prAUC      Accuracy   Kappa      Mean_F1
    2   1.6220203  0.6819509  0.2921264  0.8452941  0.0000000  NaN    
   52   0.5449850  0.7282228  0.4050232  0.8413333  0.1971006  NaN    
  103   0.5918456  0.7244949  0.3900155  0.8391765  0.2070875  NaN    
  Mean_Sensitivity  Mean_Specificity  Mean_Pos_Pred_Value  Mean_Neg_Pred_Value
  0.3333333         0.6666667               NaN                  NaN          
  0.3871093         0.7170227         0.4404578            0.7830123          
  0.3911812         0.7209896         0.4373405            0.7795070          
  Mean_Precision  Mean_Recall  Mean_Detection_Rate  Mean_Balanced_Accuracy
        NaN       0.3333333    0.2817647            0.5000000             
  0.4404578       0.3871093    0.2804444            0.5520660             
  0.4373405       0.3911812    0.2797255            0.5560854             

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was mtry = 2.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the same data (or a test dataset if you have one)</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> sample_data)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predictions, sample_data<span class="sc">$</span>Diabetes_012)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    X0    X1    X2
        X0 21555   431  3514
        X1     0     0     0
        X2     0     0     0

Overall Statistics
                                          
               Accuracy : 0.8453          
                 95% CI : (0.8408, 0.8497)
    No Information Rate : 0.8453          
    P-Value [Acc &gt; NIR] : 0.5042          
                                          
                  Kappa : 0               
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: X0 Class: X1 Class: X2
Sensitivity             1.0000    0.0000    0.0000
Specificity             0.0000    1.0000    1.0000
Pos Pred Value          0.8453       NaN       NaN
Neg Pred Value             NaN    0.9831    0.8622
Prevalence              0.8453    0.0169    0.1378
Detection Rate          0.8453    0.0000    0.0000
Detection Prevalence    1.0000    0.0000    0.0000
Balanced Accuracy       0.5000    0.5000    0.5000</code></pre>
</div>
</div>
</section>
</section>
<section id="knn" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="knn"><span class="header-section-number">1.3</span> KNN</h2>
<section id="training-2" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="training-2"><span class="header-section-number">1.3.1</span> Training</h3>
</section>
<section id="results-2" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="results-2"><span class="header-section-number">1.3.2</span> Results</h3>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>